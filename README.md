# Getting started with Serenity and Cucumber

Serenity BDD is a library that makes it easier to write high quality automated acceptance tests, with powerful reporting and living documentation features. It has strong support for both web testing with Selenium, and API testing using RestAssured.

Serenity strongly encourages good test automation design, and supports several design patterns, including classic Page Objects, the newer Lean Page Objects/ Action Classes approach, and the more sophisticated and flexible Screenplay pattern.

The latest version of Serenity supports Cucumber 6.x.

## The starter project
The best place to start with Serenity and Cucumber is to clone or download the starter project on Github ([https://github.com/serenity-bdd/serenity-cucumber-starter](https://github.com/serenity-bdd/serenity-cucumber-starter)). This project gives you a basic project setup, along with some sample tests and supporting classes. There are two versions to choose from. The master branch uses a more classic approach, using action classes and lightweight page objects, whereas the **[screenplay](https://github.com/serenity-bdd/serenity-cucumber-starter/tree/screenplay)** branch shows the same sample test implemented using Screenplay.
1. New Project with maven
2. Setup directory structure
3. Create scenario test
4. Create step definition
5. Executing scenario test

### The project directory structure
The project has build scripts for both Maven and Gradle, and follows the standard directory structure used in most Serenity projects:
```Gherkin
src
  + main
  + test
    + java                        Test runners and supporting code
    + resources
      + Features                  Feature files
     + LoginDbs              Feature file subdirectories 
             Login.feature
```

Serenity 2.2.13 introduced integration with WebdriverManager to download webdriver binaries.

## The sample scenario
Both variations of the sample project uses the sample Cucumber scenario. In this scenario, Sergey (who likes to search for stuff) is performing a search on the internet:

```Gherkin
Feature: DBS  - login

  Scenario: User has success to login DBS
    Given user open DBS login page
    When user input email and password
    And user click button login
    Then user can views success notification
    And user direct to secure area page
```
### The Screenplay implementation
The sample code in the master branch uses the Screenplay pattern. The Screenplay pattern describes tests in terms of actors and the tasks they perform. Tasks are represented as objects performed by an actor, rather than methods. This makes them more flexible and composable, at the cost of being a bit more wordy. Here is an example:
```java
     @Given("{actor} open DBS login page")
public void userOpenDBSLoginPage(Actor actor) throws Exception {
        actor.wasAbleTo(NavigateTo.theURL("DBS Login"));
        }

@When("{actor} input email and password")
public void userInputEmailAndPassword(Actor actor) throws Exception {
        Dotenv dotenv = Dotenv.load();

        String username = dotenv.get("USERNAME_DBS");
        String password = dotenv.get("PASSWORD_DBS");

        actor.attemptsTo(
        InputText.onField("DBS username", username),
        InputText.onField("DBS password", password)
        );
        }

@And("{actor} click button login")
public void userClickButtonLogin(Actor actor) throws Exception {
        actor.attemptsTo(
        ClickOn.button("DBS Button Login")
        );

        }

@Then("{actor} can views success notification")
public void userCanViewsSuccessNotification(Actor actor) throws Exception {
        actor.attemptsTo(
        VerifyMessage.element("Success Message")
        );

        }

@And("{actor} direct to secure area page")
public void userDirectToSecureAreaPage(Actor actor) throws Exception{
        actor.attemptsTo(
        VerifyMessage.element("Secure Area")
        );
        }
```

## Executing the tests
To run the sample project, you can either just run the `CucumberTestSuite` test runner class, or run either `mvn verify` from the command line.

```Login Success
$ mvn clean verify -Dtags=@Login_Successfully
```
Or
```Login Failed
$ mvn clean verify -Dtags=@Login_Usuccessfully
```

The test results will be recorded in the `target/site/serenity` directory.

## Generating the reports
Since the Serenity reports contain aggregate information about all of the tests, they are not generated after each individual test (as this would be extremenly inefficient). Rather, The Full Serenity reports are generated by the `serenity-maven-plugin`. You can trigger this by running `mvn serenity:aggregate` from the command line or from your IDE.

They reports are also integrated into the Maven build process: the following code in the `pom.xml` file causes the reports to be generated automatically once all the tests have completed when you run `mvn verify`?

```

